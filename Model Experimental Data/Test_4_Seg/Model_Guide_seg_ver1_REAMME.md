# YOLOv8 세그멘테이션 학습 가이드

[![라이센스: MIT](https://img.shields.io/badge/라이센스-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Python: 3.8+](https://img.shields.io/badge/Python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![Ultralytics: YOLOv8](https://img.shields.io/badge/Ultralytics-YOLOv8--seg-green.svg)](https://github.com/ultralytics/ultralytics)

## 📝 개요

이 저장소는 YOLOv8 세그멘테이션 모델을 학습하기 위한 Python 스크립트를 포함하고 있습니다. 객체 감지(ver1-3)에서 한 단계 발전하여 객체의 정확한 형태를 인식하는 세그멘테이션 모델을 구현했습니다. 클래스 불균형 처리 기능과 최적화된 학습 파라미터를 포함합니다.

## ✨ 주요 기능

- JSON 다각형/사각형을 YOLO 세그멘테이션 형식으로 변환
- 클래스 분포 분석 및 가중치 자동 계산
- 데이터셋 자동 분할 및 전처리
- 세그멘테이션 전용 모델 학습 (YOLOv8n-seg, YOLOv8s-seg, YOLOv8m-seg)
- 세그멘테이션 특화 평가 지표
- 사용자 친화적 인터페이스

## 🚀 시작하기

### 필수 라이브러리

```bash
pip install ultralytics torch opencv-python pillow matplotlib tqdm koreanize_matplotlib
```

### 기본 사용법

1. 데이터셋 준비:
   - 이미지 파일 (JPG, PNG)
   - JSON 주석 파일 (다각형/사각형 형태)
   - `classes.txt` 파일 (한 줄에 클래스명 하나씩)

2. 스크립트 실행:
   ```bash
   python model_seg_ver1.py
   ```

3. 프롬프트에 따라 선택:
   - 세그멘테이션 모델 크기 (n, s, m)
   - 이미지 크기 (640, 832, 1024)
   - 에폭 수 및 배치 크기
   - 새 모델 학습 또는 기존 모델 계속 학습

## 📋 객체 감지와 세그멘테이션 비교

| 기능 | 객체 감지 (Ver1-3) | 세그멘테이션 (Seg-Ver1) |
|---------|-----------|-----------|
| 주요 태스크 | 객체 위치 및 클래스 예측 | 픽셀 단위 객체 마스크 생성 |
| 출력 형태 | 바운딩 박스 | 정밀한 객체 마스크 |
| 데이터 형식 | 클래스 ID, x, y, w, h | 클래스 ID, x1, y1, x2, y2, ... |
| 수행 작업 | 객체 식별 및 추적 | 객체 형태 정확히 인식 |
| 활용 분야 | 일반 객체 감지 | 정밀한 객체 분리가 필요한 작업 |
| 계산 요구사항 | 낮음 - 중간 | 중간 - 높음 |
| 추론 속도 | 빠름 | 상대적으로 느림 |
| 모델 크기 | 작음 - 중간 | 중간 - 큼 |

## 💡 세그멘테이션 모델의 주요 특징

### 1. 정밀한 형태 인식

- **다각형 지원**: JSON의 다각형 형태를 YOLO 세그멘테이션 형식으로 정확히 변환
- **픽셀 수준 예측**: 객체의 정확한 경계를 픽셀 단위로 인식

### 2. 클래스 균형 최적화

- **클래스 분포 분석**: 세그멘테이션 데이터의 클래스별 출현 빈도 계산
- **클래스 가중치 적용**: 희소 클래스에 더 높은 가중치 부여 (최대 30배)
- **클래스 균형 시각화**: 분포 및 가중치 그래프로 데이터 불균형 파악

### 3. 모델 크기 옵션

- **YOLOv8n-seg**: 가볍고 빠른 모델 (기본값)
- **YOLOv8s-seg**: 균형 잡힌 모델
- **YOLOv8m-seg**: 높은 정확도 모델

### 4. 세그멘테이션 특화 설정

- 마스크 오버랩 허용
- 세그멘테이션 특화 학습 매개변수
- 클래스별 최적화 가중치

## 📊 평가 지표

모델은 다음 고급 지표로 평가됩니다:
- mAP50(B) & mAP50-95(B): 바운딩 박스 기준 평가
- mAP50(M) & mAP50-95(M): 마스크 기준 평가
- Precision(B/M): 박스/마스크 정밀도
- Recall(B/M): 박스/마스크 재현율

## 📈 성능 최적화 옵션

이 스크립트는 다음과 같은 세그멘테이션 성능 최적화 옵션을 제공합니다:

1. **모델 크기 선택**:
   - 가벼운 모델 (YOLOv8n-seg): 빠른 추론 속도, 제한된 리소스
   - 중간 모델 (YOLOv8s-seg): 균형 잡힌 성능
   - 무거운 모델 (YOLOv8m-seg): 높은 정확도 필요시

2. **이미지 크기 조정**:
   - 기본값 640px: 일반적인 용도
   - 832px: 향상된 세그멘테이션 경계 정확도
   - 1024px: 최대 정확도 (더 많은 계산 자원 필요)

3. **자동 학습 최적화**:
   - 인내심(patience) 파라미터: 20 에폭
   - 워밍업 에폭: 5 에폭
   - 최적화된 학습률 스케줄링
   - 마지막 10 에폭에서 모자이크 비활성화

## 📂 학습 결과 저장 위치

```
runs/segment/train/       # 첫 번째 학습 세션
runs/segment/train2/      # 두 번째 학습 세션
...

runs/segment/train/weights/
    best.pt              # 최고 성능 모델
    last.pt              # 마지막 에포크 모델
```

## 📄 라이센스

이 프로젝트는 MIT 라이센스 하에 배포됩니다 - 자세한 내용은 LICENSE 파일을 참조하세요.