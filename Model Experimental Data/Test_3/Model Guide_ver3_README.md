# YOLOv8 학습 가이드 (버전 3)

[![라이센스: MIT](https://img.shields.io/badge/라이센스-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Python: 3.8+](https://img.shields.io/badge/Python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![Ultralytics: YOLOv8](https://img.shields.io/badge/Ultralytics-YOLOv8-green.svg)](https://github.com/ultralytics/ultralytics)

## 📝 개요

이 저장소는 YOLOv8 객체 감지 모델을 학습하기 위한 Python 스크립트를 포함하고 있습니다. 버전 3는 클래스 불균형 문제를 해결하기 위한 클래스 가중치 적용과 향상된 데이터 증강 기능이 추가되었습니다.

## ✨ 주요 기능

- JSON 주석을 YOLO 형식으로 변환
- 클래스 분포 분석 및 가중치 자동 계산
- 클래스 빈도에 따른 스마트 데이터 증강
- 최적화된 학습 파라미터 설정
- 모델 학습 및 평가 기능
- 결과 시각화 (클래스 분포, 증강 샘플, 학습 곡선)

## 🚀 시작하기

### 필수 라이브러리

```bash
pip install ultralytics torch albumentations opencv-python pillow matplotlib tqdm koreanize_matplotlib
```

### 기본 사용법

1. 데이터셋 준비:
   - 이미지 파일 (JPG, PNG)
   - JSON 주석 파일
   - `classes.txt` 파일 (한 줄에 클래스명 하나씩)

2. 스크립트 실행:
   ```bash
   python model_ver_3.py
   ```

3. 프롬프트에 따라 선택:
   - 새 모델 학습
   - 기존 모델에서 계속 학습

## 📋 버전 비교

| 기능 | 버전 1 | 버전 2 | 버전 3 |
|---------|-----------|-----------|-----------|
| 기본 YOLOv8 학습 | ✅ | ✅ | ✅ |
| JSON에서 YOLO 변환 | ✅ | ✅ | ✅ |
| 데이터셋 분할 | ✅ | ✅ | ✅ |
| 기본 데이터 증강 | ❌ | ✅ | ✅ |
| Albumentations 통합 | ❌ | ✅ | ✅ |
| 증강 샘플 시각화 | ❌ | ✅ | ✅ |
| 클래스 빈도 분석 | ❌ | ❌ | ✅ |
| 클래스별 가중치 적용 | ❌ | ❌ | ✅ |
| 희소 클래스 강화 증강 | ❌ | ❌ | ✅ |
| 클래스 분포 시각화 | ❌ | ❌ | ✅ |
| 최적화된 학습 매개변수 | ❌ | ❌ | ✅ |

## 💡 버전 3의 개선사항

### 1. 클래스 불균형 처리

- **클래스 빈도 분석**: 데이터셋의 클래스별 출현 빈도 자동 계산
- **클래스 가중치 적용**: 희소 클래스에 더 높은 가중치 부여 (최대 30배)
- **가중치 시각화**: 클래스 분포 및 가중치 그래프 자동 생성

### 2. 스마트 데이터 증강

- **클래스 기반 증강**: 희소 클래스 포함 이미지에 더 강력한 증강 적용
- **적응형 증강 횟수**: 클래스 빈도에 따라 증강 횟수 자동 조정
  - 매우 희소 클래스 (100개 미만): 10회 증강
  - 희소 클래스 (300개 미만): 7회 증강
  - 준희소 클래스 (500개 미만): 5회 증강
  - 일반 클래스: 3회 증강

### 3. 향상된 증강 기법

- **기본 증강**: 좌우 반전, 회전, 밝기/대비 조정 등
- **강화 증강**: 희소 클래스용 추가 기법
  - 상하 반전 (30% 확률)
  - 원근 변환 (30% 확률)
  - HSV 조정 (30% 확률)
  - 태양 플레어 효과 (10% 확률)
  - 안개 효과 (10% 확률)

### 4. 최적화된 학습 매개변수

- 인내심(patience) 증가: 20 에포크
- 워밍업 에포크 증가: 5 에포크
- 최적화된 학습률 설정
- 가중치 감쇠 적용
- 마지막 10 에포크에서 모자이크 비활성화

## 📊 평가 지표

모델은 다음 지표로 평가됩니다:
- mAP50
- mAP50-95
- Precision (정밀도)
- Recall (재현율)
- F1-Score (F1 점수)

## 📈 성능 향상 팁

모델 성능이 불충분한 경우:

1. 이미지 크기 증가:
   - 기본값 640에서 832 또는 1280으로 증가

2. 세그멘테이션으로 전환:
   - 객체 감지로 시작하여 성능 평가
   - 필요시 세그멘테이션으로 전환

3. 모델 최적화 기법 적용:
   - 양자화(Quantization)
   - 프루닝(Pruning)
   - 지식 증류(Knowledge Distillation)

4. 하이브리드 접근법:
   - 빠른 객체 감지로 객체 찾기
   - 중요 객체에만 선택적 세그멘테이션 적용

## 📂 학습 결과 저장 위치

```
runs/detect/train/       # 첫 번째 학습 세션
runs/detect/train2/      # 두 번째 학습 세션
...

runs/detect/train/weights/
    best.pt              # 최고 성능 모델
    last.pt              # 마지막 에포크 모델
```

## 📄 라이센스

이 프로젝트는 MIT 라이센스 하에 배포됩니다 - 자세한 내용은 LICENSE 파일을 참조하세요.